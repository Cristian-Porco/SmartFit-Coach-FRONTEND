<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<link rel="stylesheet" href="%sveltekit.assets%/css/style_base.css">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;700&display=swap">
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div class="icon-sidebar">
			<a href="/account"><div class="icon-item">
				<img id="profile_picture"
					 class="profile-avatar"
					 src="http://127.0.0.1:8000/media/profile_pics/default.jpg"
					 alt="Avatar">
			</div></a>
			<a href="/account/weights"><div class="icon-item">
				<i class="material-symbols-outlined">weight</i>
			</div></a>
			<a href="/account/body-measurements"><div class="icon-item">
				<i class="material-symbols-outlined">body_fat</i>
			</div></a>
			<a href="/account/food-programs"><div class="icon-item">
				<i class="material-symbols-outlined">restaurant</i>
			</div></a>
			<a href="/account/gym-programs"><div class="icon-item">
				<i class="material-symbols-outlined">exercise</i>
			</div></a>
			<a href="/logout"><div class="icon-item">
				<i class="material-icons">logout</i>
			</div></a>
		</div>
		<div class="sidebar">
			<a href="/#home"><div class="menu-item">
				<i class="material-icons">home</i> <p>Home</p>
			</div></a>
			<a href="/#chi-siamo"><div class="menu-item">
				<i class="material-icons">info</i> <p>Chi siamo</p>
			</div></a>
			<a href="/#contatti"><div class="menu-item">
				<i class="material-icons">mail</i> <p>Contatti</p>
			</div></a>
			<div class="menu-separator"></div>
			<a href="/login"><div class="menu-item">
				<i class="material-icons">login</i> <p>Accedi</p>
			</div></a>
			<a href="/signup"><div class="menu-item">
				<i class="material-icons">person_add</i> <p>Registrati</p>
			</div></a>
		</div>
		<div class="content">
			<div class="header">
				<h1><a href="/">SmartFit Coach</a></h1>
			</div>
			<div class="main-content">
				%sveltekit.body%
			</div>
			<div class="footer">
				<p>&copy; 2025 SmartFit Coach. Tutti i diritti riservati.</p>
			</div>
		</div>
	</body>
	<script src="%sveltekit.assets%/js/js_base.js" defer></script>
	<script>
		function getCookie(name) {
			const value = `; ${document.cookie}`;
			const parts = value.split(`; ${name}=`);
			if (parts.length === 2) return parts.pop().split(';').shift();
		}
	
		const csrftoken = getCookie('csrftoken');
	
		if (csrftoken) {
			fetch('http://127.0.0.1:8000/api/v1/data/detailsaccount/me/', {
				headers: {
					'Authorization': 'Token ' + csrftoken
				}
			})
			.then(response => {
				if (!response.ok) {
					throw new Error('Errore nel recupero del profilo');
				}
				return response.json();
			})
			.then(data => {
				const img = document.getElementById('profile_picture');
				if (data.profile_picture) {
					img.src = data.profile_picture;
				}
			});
		}
	</script>
</html>